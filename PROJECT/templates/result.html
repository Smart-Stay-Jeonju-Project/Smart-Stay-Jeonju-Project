{% extends "layout.html" %}

{% block title %}ìƒì„¸ í˜ì´ì§€{% endblock %}

{% block contents %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css')}}">

<div class="accommodation-detail-container" style="max-width: 1200px; margin: auto; padding: 2rem 1rem;">

    <!-- ìˆ™ì†Œ ì´ë¯¸ì§€ + ì •ë³´ -->
    <div class="top-section">
        <!-- ìˆ™ì†Œ ì´ë¯¸ì§€ -->
        <div class="image-section">
            <!--ìˆ™ì†Œ ê²½ë¡œ ì˜¤ë¥˜ : ì ˆëŒ€ê²½ë¡œë¡œ ìˆ˜ì • -->
            <!-- oneerror : ì´ë¯¸ì§€ íŒŒì¼ ì—†ëŠ” ê²½ìš° ëŒ€ì²´ í•  ì´ë¯¸ì§€ ì„¤ì •-->
            <img src="{{ url_for('static', filename='images/tmp/' + result_accommodation.image) }}" 
            onerror="this.src='{{ url_for('static', filename='images/tmp/logo.jpg') }}'"
            alt="{{ result_accommodation.name }}">
        </div>

        <!-- ìˆ™ì†Œ ì •ë³´ -->  
        <div class="info-section">
            <h2>{{ result_accommodation.name }}</h2>
            {% if result_accommodation.feature != None %}
                <p>[{{ result_accommodation.feature}}]</p>
            {% endif %}
            <p><strong>ì£¼ì†Œ:</strong> {{ result_accommodation.address }}</p>
            <p><strong>ê°ì„±ì ìˆ˜:</strong> ğŸ™‚: 00 , ğŸ™: 00 </p>
            <div id="keywordList" style="margin-top: 10px;">
                <p><strong>í‚¤ì›Œë“œ:</strong>
                    <ul id="keywordUI"></ul>
                        {% for keyword in result_keyword %}
                            <li>
                                <a href="{{ url_for('main.search') }}?search_type=keyword&search_term={{ keyword['keyword_text'] }}">
                                    {{ keyword['keyword_text'] }}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </p>
            </div>
            <!-- {{ result_accommodation.rating | round(1) }}  : Jinja2 í…œí”Œë¦¿ ë¬¸ë²•ì—ì„œ ì‚¬ìš©í•˜ëŠ” í•„í„°(filter) -->
            <p><strong>í‰ì :</strong> â­ {{ result_accommodation.rating | round(1) }}ì  <!--({{ result_accommodation.rating_count }}ê°œ ë¦¬ë·°)--></p>
        </div>
        <!-- 
            <p>LAT: {{ result_accommodation.lat }}</p>
            <p>LNG: {{ result_accommodation.lng }}</p> 
        -->
        <!-- ì§€ë„ ì˜ì—­ -->
        <div id="map_in_result"></div>
        <script>
            const searchTerm = "{{ search_term }}"; 
        </script>
        <script>
            result_accommodation = {{ result_accommodation | tojson | safe }};
        </script>
        <script src="{{ url_for('static', filename='js/result_maps.js') }}"></script>
        <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDg8UOceSAXDR2NnMikougMamOyAxbdRac&callback=initMap"
            async defer>
        </script>
    </div>
    <div class="review-section">
        <div>
            <h3>AI ìš”ì•½ ë¦¬í¬íŠ¸</h3>
            {% if result_accommodation.report_text %}
                <p>{{ result_accommodation.report_text }}</p>
            {% else %}
                <p>AI ìš”ì•½ ë¦¬í¬íŠ¸ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</p>
            {% endif %}

        </div>
    </div>
    <div class="review-section">
        <div>
            <h3>ê°ì„±ë¶„ì„ í‚¤ì›Œë“œ ì›Œë“œí´ë¼ìš°ë“œ</h3>
            {% if result_accommodation.p_img or result_accommodation.n_img%}
                <p>ê¸ì •</p>
                <img  width="400px" src="{{ url_for('static', filename='images/report/' + result_accommodation.p_img) }}" alt="{{ result_accommodation.p_img }}">
                <p>ë¶€ì •</p>
                <img  width="400px" src="{{ url_for('static', filename='images/report/' + result_accommodation.n_img) }}" alt="{{ result_accommodation.n_img }}">
            {% else %}
                <p>ê°ì„±ë¶„ì„ í‚¤ì›Œë“œ ì›Œë“œí´ë¼ìš°ë“œê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</p>
            {% endif %}
        </div>
    </div>
    <!-- ë¦¬ë·° ì˜ì—­ -->
    <div class="review-section">
        <div>
            <h3>ì •ì œí•œ ë¦¬ë·° ì˜ì—­</h3>
            {% if result_review %}
                <table border = "1" width="1200px"  class="table table-striped table-hover">
                    <tr class="table-dark">
                        <td>ë‹‰ë„¤ì„</td>
                        <td>ë³„ì </td>
                        <td>íƒ€ì…</td>
                        <td>ë‚´ìš©</td>
                        <td>ì‘ì„±ë‚ ì§œ</td>
                        <td>ì¶œì²˜</td>
                    </tr>
                {% for result_review in result_review['list'] %}
                    <tr>
                        <td>{{result_review['nickname']}}</td>
                        <td>â­{{result_review['review_rating']}}ì </td>
                        <td>{{result_review['review_type']}}</td>
                        <td>{{result_review['content']}}</td>
                        <td>{{result_review['write_date']}}</td>
                        {%if result_review['review_source'] == 'y' %}
                            <td>ì—¬ê¸°ì–´ë•Œ</td>
                        {% else %}
                            <td>ì•¼ë†€ì</td>
                        {% endif%}
                    </tr>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
